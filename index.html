<!DOCTYPE html>
<html>

<head>
<title>Page Title</title>

<style>
    h1 {color:red;}
    p {color:blue;}

    #car {
    position:absolute;
    left:1000px;
    top:150px;
}

</style>





</head>


<body>

<h1>LIAM'S CAR RACE</h1>
<p id="score">SCORE: 0</p>
<img id="car" src="red_car.jpeg" alt="W3Schools.com" style="position:absolute; top:150px; left:1000px" height="100px">


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
    var obsticles=[]
    var stepsBetweenObsticles = 10;
    var stepsCounter =stepsBetweenObsticles;
    var pixlesForStep=25;
    var roadEndX = 300;
    var carPos ={x: 1000, y:150}
    var score = 0;
    var lastObstacleId=0;
    var roadWidth = 300;
    var roadEndX = 900
    var freeseObstcles=false;

    $(document).ready(function() {

             $("#car").css({top: carPos.y, left: carPos.y, position:'absolute'})
            var myInterval = setInterval(updateObstacles, 200);


     //   $("#car").animate({left: "+=1000"}, 2000);
     //   $("#car").animate({left: "-=500"}, 1000);
    });

    function updateObstacles() {
        var move=pixlesForStep
        if (freeseObstcles)move=0;
        var removeFirst = false;
        obsticles.forEach(item => {
            if (item.x < roadEndX){
                item.x += move;
                $("#"+ item.obstcleName).css({top: item.y, left: item.x, position:'absolute'})
                if ((carPos.x - item.x< 20 &&  carPos.x-item.x>0) &&
                    (Math.abs(item.y - carPos.y)<20)) alert("CRASH!!!");
                else if (!freeseObstcles)  score++;
            }
            else  {
                $("#"+ item.obstcleName).remove();
                removeFirst= true;
            }
        });
        if (removeFirst) obsticles.shift();

        if (stepsCounter > stepsBetweenObsticles){
            if (lastObstacleId < 50) lastObstacleId++
            else lastObstacleId =1;
            stepsCounter =0;
            var obstcleIdName = "obstcle" + lastObstacleId;
            var newObstcleHtml = '<img id="' + obstcleIdName + '" src="bush.jpeg" alt="W3Schools.com"  width="100px" height="100px">';
            $("body").append(newObstcleHtml);
            var newObstcle = {obstcleName: obstcleIdName, x: Math.floor( Math.random()* pixlesForStep * stepsBetweenObsticles), y: 100 + Math.floor(Math.random()* roadWidth)}
            $("#"+ obstcleIdName).css({top: newObstcle.y, left: newObstcle.x, position:'absolute'})
            obsticles.push(newObstcle)
            

        }
        if (!freeseObstcles)  stepsCounter++;
        $("#score").text("SCORE: " + score);
    }

    $(document).keydown(function (event) {
    var keycode = (event.keyCode ? event.keyCode : event.which);
   // alert(keycode)
   // var pos = $("#car").position()
    switch (keycode){
        case 38:
            if (carPos.y>120) carPos.y -= 20
            break
        case 40:
            if (carPos.y <300) carPos.y += 20
            break
        case 37:
            carPos.x -= 20
            break
        case 39:
            carPos.x += 20
            break
        case 32:
            if (freeseObstcles)freeseObstcles=false;
            else freeseObstcles=true;
            break
    }
    $("#car").css({top: carPos.y, left: carPos.x, position:'absolute'})
        
    
});


</script>
</body>
</html>
